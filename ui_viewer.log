INFO: Starting Flask Comparison Results Viewer...
INFO: Excel data cache is empty, attempting reload.
INFO: Attempting to load workbook: MA_PDP_97.0_processed.xlsx
INFO: Workbook loaded. Sheets: ['SEL- Group Ideal Agent', 'Ideal Agent with GSB - Group', 'Ideal Agent Only-AllocatorGroup', 'IdealAgent Dedicat-w_A-QCAP-Grp', 'IdealAgentDedicat-wo_A-QCAP-Grp', 'Allocator- Group', 'Dedicated w_A-QCAP- Group', 'Dedicated wo_A-QCAP- Group', 'Default Targeting- Group', 'Sheet1', 'Skill Expr', 'VQ', 'VAG', 'Skills', 'Vqs Comparison', 'Skills Comparison', 'Skill_exprs Comparison', 'Vags Comparison']
INFO: Found comparison sheets: ['Skill_exprs Comparison', 'Skills Comparison', 'Vags Comparison', 'Vqs Comparison']
INFO: Read 5087 valid rows from sheet 'Skill_exprs Comparison'.
INFO: Read 375 valid rows from sheet 'Skills Comparison'.
INFO: Read 30 valid rows from sheet 'Vags Comparison'.
INFO: Read 256 valid rows from sheet 'Vqs Comparison'.
INFO: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5001
INFO: [33mPress CTRL+C to quit[0m
INFO: 127.0.0.1 - - [14/Apr/2025 13:55:29] "[32mGET / HTTP/1.1[0m" 302 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:55:29] "GET /view/Skill_exprs%20Comparison HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:55:30] "GET /templates/list HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:55:30] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:55:44] "GET /view/Vags%20Comparison?sort_by=Concatenated+Key&order=asc&size=100 HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:55:44] "GET /templates/list HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:55:46] "GET /view/Skills%20Comparison?sort_by=Item&order=asc&size=100 HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:55:46] "GET /templates/list HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:55:48] "GET /templates HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:55:49] "[32mGET / HTTP/1.1[0m" 302 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:55:49] "GET /view/Skill_exprs%20Comparison HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:55:50] "GET /templates/list HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:55:52] "GET /templates HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:55:54] "[32mGET / HTTP/1.1[0m" 302 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:55:54] "GET /view/Skill_exprs%20Comparison HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:55:54] "GET /templates/list HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:56:13] "GET /view/Skills%20Comparison?sort_by=Concatenated+Key&order=asc&size=100 HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:56:13] "GET /templates/list HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:56:18] "GET /view/Skills%20Comparison?page=1&size=100&sort_by=Status&order=asc HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:56:18] "GET /templates/list HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:56:19] "GET /view/Skills%20Comparison?page=1&size=100&sort_by=Status&order=desc HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:56:19] "GET /templates/list HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 13:56:38] "GET /templates HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:12:12] "GET /templates HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:12:14] "[32mGET / HTTP/1.1[0m" 302 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:12:14] "GET /view/Skill_exprs%20Comparison HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:12:15] "GET /templates/list HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:12:24] "GET /view/Vqs%20Comparison?sort_by=Concatenated+Key&order=asc&size=100 HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:12:24] "GET /templates/list HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:12:26] "GET /view/Vqs%20Comparison?page=1&size=100&sort_by=Status&order=asc HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:12:26] "GET /templates/list HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:12:27] "GET /view/Vqs%20Comparison?page=1&size=100&sort_by=Status&order=desc HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:12:27] "GET /templates/list HTTP/1.1" 200 -
INFO: Refresh request received. Clearing data cache.
INFO: 127.0.0.1 - - [14/Apr/2025 14:14:01] "[32mGET /refresh HTTP/1.1[0m" 302 -
INFO: Excel data cache is empty, attempting reload.
INFO: Attempting to load workbook: ~$MA-PDP_v101_processed.xlsx
ERROR: Error reading Excel file '~$MA-PDP_v101_processed.xlsx': [Errno 13] Permission denied: '~$MA-PDP_v101_processed.xlsx'
Traceback (most recent call last):
  File "C:\Users\asghar.musani\Documents\Accounts Data\UHG\python\app\ui_viewer.py", line 508, in read_comparison_data
    logging.info(f"Attempting to load workbook: {filename}"); workbook = openpyxl.load_workbook(filename, read_only=True, data_only=True); logging.info(f"Workbook loaded. Sheets: {workbook.sheetnames}")
                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\asghar.musani\AppData\Local\Programs\Python\Python312\Lib\site-packages\openpyxl\reader\excel.py", line 346, in load_workbook
    reader = ExcelReader(filename, read_only, keep_vba,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\asghar.musani\AppData\Local\Programs\Python\Python312\Lib\site-packages\openpyxl\reader\excel.py", line 123, in __init__
    self.archive = _validate_archive(fn)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\asghar.musani\AppData\Local\Programs\Python\Python312\Lib\site-packages\openpyxl\reader\excel.py", line 95, in _validate_archive
    archive = ZipFile(filename, 'r')
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\asghar.musani\AppData\Local\Programs\Python\Python312\Lib\zipfile\__init__.py", line 1336, in __init__
    self.fp = io.open(file, filemode)
              ^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '~$MA-PDP_v101_processed.xlsx'
ERROR: Failed to read/process '~$MA-PDP_v101_processed.xlsx'.
INFO: 127.0.0.1 - - [14/Apr/2025 14:14:01] "GET / HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:14:02] "GET /templates/list HTTP/1.1" 200 -
INFO: Refresh request received. Clearing data cache.
INFO: 127.0.0.1 - - [14/Apr/2025 14:14:15] "[32mGET /refresh HTTP/1.1[0m" 302 -
INFO: Excel data cache is empty, attempting reload.
INFO: Attempting to load workbook: ~$MA-PDP_v101_processed.xlsx
ERROR: Error reading Excel file '~$MA-PDP_v101_processed.xlsx': [Errno 13] Permission denied: '~$MA-PDP_v101_processed.xlsx'
Traceback (most recent call last):
  File "C:\Users\asghar.musani\Documents\Accounts Data\UHG\python\app\ui_viewer.py", line 508, in read_comparison_data
    logging.info(f"Attempting to load workbook: {filename}"); workbook = openpyxl.load_workbook(filename, read_only=True, data_only=True); logging.info(f"Workbook loaded. Sheets: {workbook.sheetnames}")
                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\asghar.musani\AppData\Local\Programs\Python\Python312\Lib\site-packages\openpyxl\reader\excel.py", line 346, in load_workbook
    reader = ExcelReader(filename, read_only, keep_vba,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\asghar.musani\AppData\Local\Programs\Python\Python312\Lib\site-packages\openpyxl\reader\excel.py", line 123, in __init__
    self.archive = _validate_archive(fn)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\asghar.musani\AppData\Local\Programs\Python\Python312\Lib\site-packages\openpyxl\reader\excel.py", line 95, in _validate_archive
    archive = ZipFile(filename, 'r')
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\asghar.musani\AppData\Local\Programs\Python\Python312\Lib\zipfile\__init__.py", line 1336, in __init__
    self.fp = io.open(file, filemode)
              ^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '~$MA-PDP_v101_processed.xlsx'
ERROR: Failed to read/process '~$MA-PDP_v101_processed.xlsx'.
INFO: 127.0.0.1 - - [14/Apr/2025 14:14:15] "GET / HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:14:15] "GET /templates/list HTTP/1.1" 200 -
INFO: Refresh request received. Clearing data cache.
INFO: 127.0.0.1 - - [14/Apr/2025 14:14:35] "[32mGET /refresh HTTP/1.1[0m" 302 -
INFO: Excel data cache is empty, attempting reload.
INFO: Attempting to load workbook: MA-PDP_v101_processed.xlsx
INFO: Workbook loaded. Sheets: ['SEL- Group Ideal Agent', 'Ideal Agent with GSB - Group', 'Ideal Agent Only-AllocatorGroup', 'IdealAgent Dedicat-w_A-QCAP-Grp', 'IdealAgentDedicat-wo_A-QCAP-Grp', 'Allocator- Group', 'Dedicated w_A-QCAP- Group', 'Dedicated wo_A-QCAP- Group', 'Default Targeting- Group', 'Sheet1', 'Skill Expr', 'VQ', 'VAG', 'Skills', 'Vqs Comparison', 'Skills Comparison', 'Skill_exprs Comparison', 'Vags Comparison']
INFO: Found comparison sheets: ['Skill_exprs Comparison', 'Skills Comparison', 'Vags Comparison', 'Vqs Comparison']
INFO: Read 5101 valid rows from sheet 'Skill_exprs Comparison'.
INFO: Read 372 valid rows from sheet 'Skills Comparison'.
INFO: Read 30 valid rows from sheet 'Vags Comparison'.
INFO: Read 252 valid rows from sheet 'Vqs Comparison'.
INFO: 127.0.0.1 - - [14/Apr/2025 14:14:35] "[32mGET / HTTP/1.1[0m" 302 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:14:35] "GET /view/Skill_exprs%20Comparison HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:14:36] "GET /templates/list HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:14:40] "GET /view/Vqs%20Comparison?sort_by=Concatenated+Key&order=asc&size=100 HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:14:41] "GET /templates/list HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:14:43] "GET /view/Vqs%20Comparison?page=1&size=100&sort_by=Status&order=asc HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:14:43] "GET /templates/list HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:14:44] "GET /view/Vqs%20Comparison?page=1&size=100&sort_by=Status&order=desc HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [14/Apr/2025 14:14:44] "GET /templates/list HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [15/Apr/2025 15:45:58] "[32mGET / HTTP/1.1[0m" 302 -
INFO: 127.0.0.1 - - [15/Apr/2025 15:45:58] "GET /view/Skill_exprs%20Comparison HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [15/Apr/2025 15:45:59] "GET /templates/list HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [15/Apr/2025 15:45:59] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
INFO: 127.0.0.1 - - [15/Apr/2025 15:46:06] "GET /view/Skill_exprs%20Comparison?page=1&size=100&sort_by=ID&order=asc HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [15/Apr/2025 15:46:07] "GET /templates/list HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [15/Apr/2025 15:46:14] "GET /view/Skill_exprs%20Comparison?page=1&size=100&sort_by=Ideal+Expression&order=asc HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [15/Apr/2025 15:46:14] "GET /templates/list HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [15/Apr/2025 15:49:15] "GET /view/Skill_exprs%20Comparison?page=1&size=100&sort_by=ID&order=asc HTTP/1.1" 200 -
INFO: 127.0.0.1 - - [15/Apr/2025 15:49:16] "GET /templates/list HTTP/1.1" 200 -
